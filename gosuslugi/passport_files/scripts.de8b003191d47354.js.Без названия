(function(h){h.IFCCrypto=function(I){this.getAlias=function(){return IFCConst.emptyString(I.alias)},this.getName=function(){return IFCConst.emptyString(I.name)},this.isPKCS11=function(){return I.type===IFCConst.IFC_CRYPTO_PKCS11},this.isCAPI=function(){return I.type===IFCConst.IFC_CRYPTO_CAPI},this.isCAPI_LINUX=function(){return I.type===IFCConst.IFC_CRYPTO_CAPI_LINUX},this.getPath=function(){return IFCConst.emptyString(I.path)},this.getNumber=function(){return IFCConst.emptyString(I.num)},this.getDescription=function(){return IFCConst.emptyString(I.description)},this.getSerialNumber=function(){return IFCConst.emptyString(I.serial_number)},this.getModel=function(){return IFCConst.emptyString(I.model)},this.getSkipPKCS11List=function(){return IFCConst.emptyString(I.skip_pkcs11_list)},this.getAlg=function(){return IFCConst.emptyString(I.alg)},this.getCryptoId=function(){return I.type===IFCConst.IFC_CRYPTO_PKCS11?I.crypto_id=I.alias+"/"+I.num:(I.type===IFCConst.IFC_CRYPTO_CAPI||I.type===IFCConst.IFC_CRYPTO_CAPI_LINUX)&&(I.crypto_id=I.alias),IFCConst.emptyString(I.crypto_id)},this.getExtendedKeyUsage=function(){for(var s=this.getAlias(),o=[{alias:"JaCarta",oid:"1.2.643.3.205.110.1"},{alias:"ruTokenECP",oid:"1.2.643.3.205.110.7"},{alias:"VIPNet",oid:"1.2.643.3.205.110.6"},{alias:"SignalCom",oid:"1.2.643.3.205.110.8"},{alias:"LISSI-CSP",oid:"1.2.643.3.205.110.9"},{alias:"CryptoPro",oid:"1.2.643.3.205.110.2"}],f=0;f<o.length;f++)if(s.indexOf(o[f].alias)>=0)return o[f].oid;return""},this.getCertificatePolicies=function(){for(var s=this.getAlias(),o=[{alias:"JaCarta",oid:IFCConst.OID_KC1+","+IFCConst.OID_KC2},{alias:"ruTokenECP",oid:IFCConst.OID_KC1+","+IFCConst.OID_KC2},{alias:"CryptoPro",oid:IFCConst.OID_KC1},{alias:"VIPNet",oid:IFCConst.OID_KC1},{alias:"SignalCom",oid:IFCConst.OID_KC1},{alias:"LISSI-CSP",oid:IFCConst.OID_KC1}],f=0;f<o.length;f++)if(s.indexOf(o[f].alias)>=0)return o[f].oid;return IFCConst.OID_KC1}},h.IFCCertificate=function(I,s){this.getSerialNumber=function(){return IFCConst.emptyString(I.cert_sn)},this.getSubjectDN=function(){return new IFCDN(IFCConst.emptyString(I.cert_subject),IFCConst.DN_SEPARATOR_PLUGIN)},this.getIssuerDN=function(){return new IFCDN(IFCConst.emptyString(I.cert_issuer),IFCConst.DN_SEPARATOR_PLUGIN)},this.getValidFrom=function(){return IFCConst.emptyString(this.checkDate(I.cert_valid_from))},this.getValidTo=function(){return IFCConst.emptyString(this.checkDate(I.cert_valid_to))},this.getSignAndDigestAlgUri=function(){var o=this.getSignAlgOid();return o===IFCConst.OID_GOSTR3410_2012_256||o===IFCConst.OID_GOSTR3410_2012_512||o===IFCConst.OID_GOSTR3410_2001?{signMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",digestMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr3411"}:{signMethod:"",digestMethod:""}},this.getSignAlg=function(){var o=this.getSignAlgOid();return o===IFCConst.OID_GOSTR3410_2001?"gost_2001":o===IFCConst.OID_GOSTR3410_2012_256?"gost_2012_256":o===IFCConst.OID_GOSTR3410_2012_512?"gost_2012_512":""},this.getSignAlgOid=function(){return IFCConst.emptyString(I.cert_sign_alg)},this.isValid=function(){return new Date<new Date(this.getValidTo())},this.getId=function(){return IFCConst.emptyString(I.id)},this.getContainerId=function(){return s.getCryptoId()+"/"+IFCConst.emptyString(I.id)},this.getCryptoId=function(){return s.getCryptoId()},this.isPKCS11=function(){return s.isPKCS11()},this.isCAPI=function(){return s.isCAPI()},this.isCAPI_LINUX=function(){return s.isCAPI_LINUX()},this.checkDate=function(o){return isNaN(new Date(o).getTime())?o.replace(/([a-z]*\s\d{1,2}\s)((?:\d{2}:?){3})\s(\d{4}\s)(.*)/i,"$1$3$2$4"):o}},h.IFCCertificateInfo=function(I){this.getSerialNumber=function(){return IFCConst.emptyString(I.cert_sn)},this.getSubjectDN=function(){return new IFCDN(IFCConst.emptyString(I.cert_subject),IFCConst.DN_SEPARATOR_PLUGIN)},this.getIssuerDN=function(){return new IFCDN(IFCConst.emptyString(I.cert_issuer),IFCConst.DN_SEPARATOR_PLUGIN)},this.getValidFrom=function(){return IFCConst.emptyString(this.checkDate(I.cert_valid_from))},this.getValidTo=function(){return IFCConst.emptyString(this.checkDate(I.cert_valid_to))},this.getSignAndDigestAlgUri=function(){var s=this.getSignAlgOid();return s===IFCConst.OID_GOSTR3410_2012_256||s===IFCConst.OID_GOSTR3410_2012_512||s===IFCConst.OID_GOSTR3410_2001?{signMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",digestMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr3411"}:{signMethod:"",digestMethod:""}},this.getSignAlg=function(){var s=this.getSignAlgOid();return s===IFCConst.OID_GOSTR3410_2001?"gost_2001":s===IFCConst.OID_GOSTR3410_2012_256?"gost_2012_256":s===IFCConst.OID_GOSTR3410_2012_512?"gost_2012_512":""},this.getSignAlgOid=function(){return IFCConst.emptyString(I.cert_sign_alg)},this.isValid=function(){return new Date<new Date(this.getValidTo())},this.getBase64=function(){return IFCConst.emptyString(I.base64)},this.getPem=function(){return IFCConst.emptyString(I.pem)},this.getVersion=function(){return IFCConst.emptyString(I.version)},this.getExtensionsString=function(){return IFCConst.emptyString(I.extensions)},this.getPrintableText=function(){return this.getPrintable("\n","\t",", ")},this.getPrintableHTML=function(){return this.getPrintable("<br />","&nbsp;&nbsp;",", ")},this.getPrintable=function(s,o,f){s||(s="\n"),o||(o="\t"),f||(f=", ");var A="\u041d\u043e\u043c\u0435\u0440 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430: "+this.getSerialNumber()+s+"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430:"+s+o+o+"\u0441 "+this.getValidFrom()+s+o+o+"\u043f\u043e "+this.getValidTo()+s+s+o+"\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430"+s+s+"\u0424\u0430\u043c\u0438\u043b\u0438\u044f, \u0438\u043c\u044f, \u043e\u0442\u0447\u0435\u0441\u0442\u0432\u043e: "+this.getSubjectDN().getCommonName()+s+"\u0421\u0442\u0440\u0430\u0445\u043e\u0432\u043e\u0439 \u043d\u043e\u043c\u0435\u0440 \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043b\u0438\u0446\u0435\u0432\u043e\u0433\u043e \u0441\u0447\u0435\u0442\u0430: "+this.getSubjectDN().getSNILS()+s+s+o+"\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e\u0431 \u0438\u0437\u0434\u0430\u0442\u0435\u043b\u0435 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430"+s+s+"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435  \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0433\u043e  \u0446\u0435\u043d\u0442\u0440\u0430: "+this.getIssuerDN().getCommonName()+s+"\u041c\u0435\u0441\u0442\u043e  \u043d\u0430\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f  \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0433\u043e \u0446\u0435\u043d\u0442\u0440\u0430: "+this.getIssuerDN().getCountryName()+f+this.getIssuerDN().getStateOrProvinceName()+f+this.getIssuerDN().getLocalityName()+f+this.getIssuerDN().getStreetAddress()+s;return this.getIssuerDN().getSurname()?A+="\u0414\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0435 \u043b\u0438\u0446\u043e \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0433\u043e \u0446\u0435\u043d\u0442\u0440\u0430: "+this.getIssuerDN().getSurname():this.getIssuerDN().getGivenName()?A+=f+this.getIssuerDN().getGivenName()+s:A+=s,A+(o+"\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430")+s+s+this.getExtensionsString().replace(/(\r\n|\n|\r)/gm,s).replace(/^\s+/gm,o)},this.checkDate=function(s){return isNaN(new Date(s).getTime())?s.replace(/([a-z]*\s\d{1,2}\s)((?:\d{2}:?){3})\s(\d{4}\s)(.*)/i,"$1$3$2$4"):s}},h.IFCDN=function(I,s){var o=function(F){switch(F.toLowerCase()){case"commonname":case"cn":return IFCConst.OID_COMMON_NAME;case"surname":return IFCConst.OID_SURNAME;case"givenname":return IFCConst.OID_GIVEN_NAME;case"countryname":case"c":return IFCConst.OID_COUNTRY_NAME;case"stateorprovincename":return IFCConst.OID_STATE_OR_PROVINCE_NAME;case"localityname":case"l":return IFCConst.OID_LOCALITY_NAME;case"streetaddress":case"street":return IFCConst.OID_STREET_ADDRESS;case"organizationname":case"o":return IFCConst.OID_ORGANIZATION_NAME;case"organizationunitname":case"ou":return IFCConst.OID_ORGANIZATION_UNIT_NAME;case"title":return IFCConst.OID_TITLE;case"emailaddress":case"email":return IFCConst.OID_EMAIL_ADDRESS;case"ogrn":return IFCConst.OID_OGRN;case"snils":return IFCConst.OID_SNILS;case"inn":return IFCConst.OID_INN;default:return F}},f=I.split("\\,").join("[escaped_comma]").split(s);this.dnData=new Object;for(var A=0;A<f.length;A++){var a=f[A].split("=");null==a[1]&&(a[1]="");var p=a[0].trim(),D=a[1].trim().split("[escaped_comma]").join(",");this.dnData[o(p)]=D}this.getCommonName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_COMMON_NAME])},this.getSurname=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_SURNAME])},this.getGivenName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_GIVEN_NAME])},this.getCountryName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_COUNTRY_NAME])},this.getStateOrProvinceName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_STATE_OR_PROVINCE_NAME])},this.getLocalityName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_LOCALITY_NAME])},this.getStreetAddress=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_STREET_ADDRESS])},this.getOrganizationName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_ORGANIZATION_NAME])},this.getOrganizationUnitName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_ORGANIZATION_UNIT_NAME])},this.getTitle=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_TITLE])},this.getEmailAddress=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_EMAIL_ADDRESS])},this.getOGRN=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_OGRN])},this.getSNILS=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_SNILS])},this.getINN=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_INN])},this.getValueByOid=function(F){return IFCConst.emptyString(this.dnData[o(F)])},this.getSubjectArray=function(){var F=new Object,R=0;for(var S in this.dnData)F["oid_"+ ++R]=S,F["oid_type_"+R]=IFCConst.getDNDataType(S),F["value_"+R]=this.dnData[S];return F.oids_count=R,F},this.getOneLine=function(){var F="";return this.getCountryName()&&(F+="c="+this.getCountryName()+", "),this.getStateOrProvinceName()&&(F+="stateorprovincename="+this.getStateOrProvinceName()+", "),this.getLocalityName()&&(F+="l="+this.getLocalityName()+", "),this.getCommonName()&&(F+="cn="+this.getCommonName()+", "),this.getSurname()&&(F+="surname="+this.getSurname()+", "),this.getGivenName()&&(F+="givenname="+this.getGivenName()+", "),this.getStreetAddress()&&(F+="street="+this.getStreetAddress()+", "),this.getOrganizationName()&&(F+="o="+this.getOrganizationName()+", "),this.getOrganizationUnitName()&&(F+="ou="+this.getOrganizationUnitName()+", "),this.getTitle()&&(F+="title="+this.getTitle()+", "),this.getEmailAddress()&&(F+="email="+this.getEmailAddress()+", "),this.getOGRN()&&(F+="ogrn="+this.getOGRN()+", "),this.getSNILS()&&(F+="snils="+this.getSNILS()+", "),this.getINN()&&(F+="inn="+this.getINN()+", "),F.substring(0,F.length-2)}},h.IFCCertificateRequest=function(I,s){this.getContainerId=function(){return I},this.getCsr=function(){return s}},h.IFCEncrypted=function(I,s,o){this.getData=function(){return I},this.getKey=function(){return s},this.getCertificate=function(){return o}},h.IFCHash=function(I){this.getBase64=function(){return I},this.getHexBinary=function(){return o(s(I))},this.getPlainData=function(){return s(I)};var s=function(f){var a,A={},D=[],F="",R=String.fromCharCode,S=[[65,91],[97,123],[48,58],[43,44],[47,48]];for(z in S)for(a=S[z][0];a<S[z][1];a++)D.push(R(a));for(a=0;a<64;a++)A[D[a]]=a;for(a=0;a<f.length;a+=72){var O,P=0,T=0,g=f.substring(a,a+72);for(O=0;O<g.length;O++)for(P=(P<<6)+A[g.charAt(O)],T+=6;T>=8;)F+=R((P>>>(T-=8))%256)}return F},o=function(f){for(var a,A=[],p="",D=0,F=f.length;D<F;++D)a=f.charCodeAt(D),A.push((a>>4).toString(16),(15&a).toString(16));for(String.prototype.concat.apply("",A),D=0;D<A.length;D++)p+=A[D];return p}},h.IFCConst={IFC_DATATYPE_DATA:1,IFC_DATATYPE_DATA_BASE64:2,IFC_DATATYPE_HASH:3,IFC_DATATYPE_HASH_BASE64:4,IFC_DATATYPE_FILENAME:5,IFC_CRYPTO_PKCS11:"pkcs11",IFC_CRYPTO_CAPI:"capi",IFC_CRYPTO_CAPI_LINUX:"capi_linux",OID_COMMON_NAME:"2.5.4.3",OID_SURNAME:"2.5.4.4",OID_GIVEN_NAME:"2.5.4.42",OID_COUNTRY_NAME:"2.5.4.6",OID_STATE_OR_PROVINCE_NAME:"2.5.4.8",OID_LOCALITY_NAME:"2.5.4.7",OID_STREET_ADDRESS:"2.5.4.9",OID_ORGANIZATION_NAME:"2.5.4.10",OID_ORGANIZATION_UNIT_NAME:"2.5.4.11",OID_TITLE:"2.5.4.12",OID_EMAIL_ADDRESS:"1.2.840.113549.1.9.1",OID_OGRN:"1.2.643.100.1",OID_SNILS:"1.2.643.100.3",OID_INN:"1.2.643.3.131.1.1",OID_KC1:"1.2.643.100.113.1",OID_KC2:"1.2.643.100.113.2",OID_KC3:"1.2.643.100.113.3",OID_GOSTR3410_2001:"1.2.643.2.2.19",OID_GOSTR3410_2012_256:"1.2.643.7.1.1.1.1",OID_GOSTR3410_2012_512:"1.2.643.7.1.1.1.2",DN_SEPARATOR_PLUGIN:"\n",DN_SEPARATOR_INPUT:",",IFC_CERT_LOAD_FROM_CONTAINER:1,IFC_CERT_LOAD_FROM_FILE:2,IFC_CERT_LOAD_FROM_STRING:3,IFC_SIGNTYPE_SIMPLE:1,IFC_SIGNTYPE_SIMPLE_REVERSE:2,IFC_SIGNTYPE_CMS_ATTACHED:3,IFC_SIGNTYPE_CMS_DETACHED:4,IFC_SIGNTYPE_CADES_BES_ATTACHED:5,IFC_SIGNTYPE_CADES_BES_DETACHED:6,IFC_HARDWARE_HASH:1,IFC_SOFTWARE_HASH:2,IFC_BASE64:1,IFC_RAW:0,IFC_SHOW_CSP_UI:1,IFC_HIDE_CSP_UI:0,IFC_X509_INFO_CERT_BASE64ENCODED:1,IFC_X509_INFO_CERT_DER:2,IFC_X509_INFO_CERT_VERSION:3,IFC_X509_INFO_CERT_SERIALNUMBER:4,IFC_X509_INFO_CERT_SUBJECT:5,IFC_X509_INFO_CERT_ISSUER:6,IFC_X509_INFO_CERT_VALIDFROM:7,IFC_X509_INFO_CERT_VALIDTO:8,IFC_X509_INFO_CERT_X509EXTENSIONS:9,IFC_X509_INFO_CERT_PEM:10,IFC_X509_INFO_CERT_ALG:11,IFC_CERT_UNKNOWN:0,IFC_CERT_DER:1,IFC_CERT_BASE64:2,IFC_CERT_PEM:3,IFC_REQ_DER:0,IFC_REQ_PEM:1,IFC_REQ_BASE64ENCODED:2,P11_PIN_TYPE_USER:0,P11_PIN_TYPE_ADMIN:1,IFC_PRINTABLE_STRING:19,IFC_IA5STRING:22,IFC_NUMERICSTRING:18,IFC_UTF8STRING:12,IFC_OCTET_STRING:4,IFC_BMPSTRING:30,APDU_FORMAT_RAW:0,APDU_FORMAT_TEXT:1,SHOW_SAFETOUCH:0,getDNDataType:function(I){var s;switch(I){case this.OID_COUNTRY_NAME:s=this.IFC_PRINTABLE_STRING;break;case this.OID_SNILS:case this.OID_OGRN:case this.OID_INN:s=this.IFC_NUMERICSTRING;break;case this.OID_EMAIL_ADDRESS:s=this.IFC_IA5STRING;break;default:s=IFCConst.IFC_UTF8STRING}return s},emptyString:function(I){return null==I?"":I}},h.IFCError={IFC_GENERAL_ERROR:-1,IFC_OK:0,IFC_ERROR_UNKNOWN:1,IFC_ERROR_CONFIG:2,IFC_ERROR_RECORD_MAX:3,IFC_ERROR_CONFIG_EMPTY:4,IFC_BAD_PARAMS:5,IFC_ERROR_MALLOC:6,IFC_ALIAS_NOT_FOUND:7,IFC_ERROR_STORE:8,IFC_CERT_NOT_FOUND:9,IFC_CONTAINER_NOT_FOUND:10,IFC_UNSUPPORTED_FORMAT:11,IFC_KEY_NOT_FOUND:12,IFC_BAD_IN_TYPE:13,IFC_BAD_SIGN_TYPE:14,IFC_BAD_HASH_CONTEXT:15,IFC_BAD_TYPE_PIN:16,IFC_NOT_SUPPORTED:17,IFC_SLOT_NOT_INIT:18,IFC_ERROR_VERIFY:19,IFC_ERROR_BASE64:20,IFC_SC_ERROR:21,IFC_ENGINE_ERROR:22,IFC_P11_ERROR:23,IFC_P11_NO_TOKENS_FOUND:25,IFC_PARSE_XML_ERROR:26,IFC_XPATH_ERROR:27,IFC_CANON_XML_ERROR:28,IFC_P11_LOGIN_ERROR:160,IFC_UNICODE_ERROR:161,IFC_ENCODINGS_ERROR:162,IFC_INIT_ERROR:163,IFC_CRYPTO_NOT_FOUND:164,IFC_PLUGIN_UNDEFINED_ERROR:256,IFC_P11_INVALID_PIN_ERROR:257,getErrorDescription:function(I){switch(I){case IFCError.IFC_GENERAL_ERROR:return"\u041e\u0431\u0449\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430";case IFCError.IFC_OK:return"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e";case IFCError.IFC_ERROR_UNKNOWN:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0430";case IFCError.IFC_ERROR_CONFIG:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438";case IFCError.IFC_ERROR_RECORD_MAX:return"\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438";case IFCError.IFC_ERROR_CONFIG_EMPTY:return"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u043d\u0435 \u043e\u043f\u0435\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0430";case IFCError.IFC_BAD_PARAMS:return"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u043d\u044b \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_ERROR_MALLOC:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043f\u0430\u043c\u044f\u0442\u0438";case IFCError.IFC_ALIAS_NOT_FOUND:return"\u0423\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a \u043a\u0440\u0438\u043f\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_ERROR_STORE:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435\u043c";case IFCError.IFC_CERT_NOT_FOUND:return"\u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_CONTAINER_NOT_FOUND:return"\u041a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_UNSUPPORTED_FORMAT:return"\u0424\u043e\u0440\u043c\u0430\u0442 \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f";case IFCError.IFC_KEY_NOT_FOUND:return"\u041a\u043b\u044e\u0447 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_BAD_IN_TYPE:return"\u0422\u0438\u043f \u0432\u0445\u043e\u0434\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_BAD_SIGN_TYPE:return"\u0422\u0438\u043f \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0434\u043f\u0438\u0441\u0438 \u0437\u0430\u0434\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_BAD_HASH_CONTEXT:return"\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0445\u0435\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_BAD_TYPE_PIN:return"\u0422\u0438\u043f \u043f\u0438\u043d-\u043a\u043e\u0434\u0430 \u0437\u0430\u0434\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_NOT_SUPPORTED:return"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f";case IFCError.IFC_SLOT_NOT_INIT:return"\u0421\u043b\u043e\u0442 \u043d\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d";case IFCError.IFC_ERROR_VERIFY:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u0438";case IFCError.IFC_ERROR_BASE64:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0438 BASE64";case IFCError.IFC_SC_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0434\u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0441\u043c\u0430\u0440\u0442-\u043a\u0430\u0440\u0442";case IFCError.IFC_ENGINE_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430";case IFCError.IFC_P11_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u043e\u0439 PKCS#11";case IFCError.IFC_P11_NO_TOKENS_FOUND:return"\u0421\u043c\u0430\u0440\u0442-\u043a\u0430\u0440\u0442\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430";case IFCError.IFC_PARSE_XML_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 XML";case IFCError.IFC_XPATH_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f XPath";case IFCError.IFC_CANON_XML_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u0430\u043d\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 XML";case IFCError.IFC_P11_LOGIN_ERROR:return"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043f\u0438\u043d-\u043a\u043e\u0434";case IFCError.IFC_UNICODE_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 UNICODE";case IFCError.IFC_ENCODINGS_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0438";case IFCError.IFC_INIT_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430";case IFCError.IFC_CRYPTO_NOT_FOUND:return"\u0421\u041a\u0417\u0418 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e";case IFCError.IFC_PLUGIN_UNDEFINED_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043f\u043b\u0430\u0433\u0438\u043d\u0430";case IFCError.IFC_P11_INVALID_PIN_ERROR:return"\u041f\u0438\u043d-\u043a\u043e\u0434 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u043c";default:return"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430"}}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})})(window),function(h){h.IFCPlugin=function(I,s,o){var A="",a=null;function p(r){if(document.createEvent){var t=document.createEvent("Event");t.initEvent(r,!0,!0),document.dispatchEvent(t)}else document.documentElement[r]++}function R(){var r=navigator.userAgent;if(-1!==r.search("Safari")&&-1!==r.search("Version")){var t=r.indexOf("Version")+8,e=r.substr(t);if(e){var n=t+e.indexOf(".");if((e?parseInt(r.substring(t,n),10):0)>=12)return!0}}return!1}function S(){for(var r=navigator.userAgent,t=["Firefox","Chrome","Opera","Edge","YaBrowser","Safari"],e=0;e<t.length;e++){if(-1!==r.search(t[e])&&"Firefox"===t[e]){var n=r.indexOf(t[e])+8,i=r.substr(n);if(i){var _=n+i.indexOf(".");if((i?parseInt(r.substring(n,_),10):0)>=50)return!0}break}if(-1!==r.search(t[e])&&"Safari"===t[e]&&-1!==r.search("Version")){var c=r.indexOf("Version")+8,u=r.substr(c);if(u){var E=c+u.indexOf(".");if((u?parseInt(r.substring(c,E),10):0)>=12)return!0}break}if(-1!==r.search(t[e]))return!0}return!1}function P(r,t){a.send({func_name:"get_list_info",params:{cryptoType:r}},function(e){if(IFCError.IFC_OK===e.error_code){for(var n=[],i=0;i<e.ifc_list.length;i++)(e.ifc_list[i].type===r||null==r)&&n.push(new IFCCrypto(e.ifc_list[i]));t({error_code:IFCError.IFC_OK,ifc_list:n})}else t(e)})}function l(r){return P(null,r)}function O(r,t){l(function(e){if(IFCError.IFC_OK===e.error_code){for(var n=0;n<e.ifc_list.length;n++)if(r===e.ifc_list[n].getCryptoId())return void t({error_code:IFCError.IFC_OK,crypto:e.ifc_list[n]});t({error_code:IFCError.IFC_CRYPTO_NOT_FOUND,crypto})}else t(e)})}function T(r){if(!r)return"";for(var t=["CryptoPro","VIPNet","SignalCom","LISSI-CSP"],e=0;e<t.length;e++)if(r.indexOf(t[e])>=0)return r.substring(0,r.indexOf("/"));return r.substring(0,r.lastIndexOf("/"))}function g(r,t,e,n,i,_,C){O(T(r),function(c){IFCError.IFC_OK===c.error_code?(void 0===C&&(C=IFCConst.IFC_SHOW_CSP_UI),a.send({func_name:"sign",params:{containerId:r,userPin:t||"",inDataType:n,data:e,hashType:IFCConst.IFC_HARDWARE_HASH,signType:i,cspUI:C,outDataType:IFCConst.IFC_BASE64}},_)):_(c)})}function N(r,t,e,n,i,_,C){_?v(_,function(c){if(IFCError.IFC_OK===c.error_code){var u=c.x509Handle;a.send({func_name:"verify",params:{containerId:r,inDataType:i,data:n,signType:e,sign:t,x509Handle:u}},function(E){var y,d=E.error_code;IFCError.IFC_OK===E.error_code&&(y=E.verify_result),m(u,function(x){IFCError.IFC_OK===x.error_code?C({error_code:d,verify_result:y}):C(x)})})}else C(c)}):a.send({func_name:"verify",params:{containerId:r,inDataType:i,data:n,signType:e,sign:t,x509Handle:0}},C)}function Y(r,t,e,n,i,_,C,c){O(T(r),function(u){IFCError.IFC_OK===u.error_code?(void 0===c&&(c=1),a.send({func_name:"sign_xml",params:{containerId:r,userPin:t||"",wsu_id:e,inDataType:i,data:n,cspUI:c,outDataType:_}},C)):C(u)})}function K(r,t,e,n,i){a.send({func_name:"verify_xml",params:{containerId:r,wsu_id:t,inDataType:n,sign:e}},function(_){IFCError.IFC_OK===_.error_code?i({error_code:_.error_code,verify_result:_.verify_result}):i(_)})}function H(r,t,e,n){a.send({func_name:"hash",params:{containerId:r,inDataType:t,data:e,outDataType:IFCConst.IFC_BASE64}},function(i){IFCError.IFC_OK===i.error_code?n({error_code:IFCError.IFC_OK,hash:new IFCHash(i.hashValue)}):n(i)})}function U(r,t){l(function(e){if(IFCError.IFC_OK===e.error_code){for(var n=e.ifc_list,i=[],_=0;_<n.length;_++)i.push(n[_].getCryptoId());a.send({func_name:"get_list_certs_by_cryptoid_array",params:{cryptoID_array:i,show_progress:t}},function(C){if(IFCError.IFC_OK===C.error_code)if(C.intermediate)r(C);else{for(var c=[],u=0;u<C.result_array.length;u++){for(var E=!1,d=0;d<n.length;d++)if(n[d].getCryptoId()===C.result_array[u].crypto_id){E=n[d];break}if(!1!==E)for(var y=0;y<C.result_array[u].cert_list.length;y++)c.push(new IFCCertificate(C.result_array[u].cert_list[y],E))}r({error_code:IFCError.IFC_OK,certs_list:c})}else r(C)})}else r(e)})}function M(r,t,e,n,i){O(T(r),function(C){IFCError.IFC_OK===C.error_code?t&&t.length>0||!C.crypto.isPKCS11()?function B(r,t,e,n,i,_,C){a.send({func_name:"key_gen",params:{containerId:r,userPin:t}},function(c){if(IFCError.IFC_OK===c.error_code){var E=new IFCDN(e,IFCConst.DN_SEPARATOR_INPUT).getSubjectArray(),y=("clientAuth,emailProtection,1.2.643.2.2.34.6,"+n).split(","),x=i.split(","),G=c.real_id;a.send({func_name:"req_gen",params:{containerId:G,userPin:t,subject:E,extendedKeyUsage:y,certificatePolicies:x,signInstrument:"",req_format:IFCConst.IFC_REQ_BASE64ENCODED,csrExtensions:_}},function(L){IFCError.IFC_OK===L.error_code?C({error_code:IFCError.IFC_OK,real_id:G,req_base64_length:L.req_base64_length,req_base64:L.req_base64,req:new IFCCertificateRequest(G,L.req_base64)}):C(L)})}else C(c)})}(r,t,e,C.crypto.getExtendedKeyUsage(),C.crypto.getCertificatePolicies(),n,i):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):i(C)})}function w(r){a.send({func_name:"get_guid",params:{prefix:A}},r)}function V(r,t,e,n,i){w(function(_){if(IFCError.IFC_OK===_.error_code)return M(r+"/"+_.guid,t,e,n,i);i(_)})}function X(r,t,e){O(T(r),function(n){IFCError.IFC_OK===n.error_code?t&&t.length>0||!n.crypto.isPKCS11()?a.send({func_name:"key_delete",params:{containerId:r,userPin:t}},e):e({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):e(n)})}function v(r,t){a.send({func_name:"load_x509_from_data",params:{cert:r,cert_data_type:IFCConst.IFC_CERT_UNKNOWN}},t)}function m(r,t){a.send({func_name:"free_x509",params:{x509Handle:r}},t)}function j(r,t,e,n){e&&e.length>0?a.send({func_name:"p11_key_rename",params:{containerId:r,newContainerId:t,userPin:e}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}this.status=null,this.safariExtensionScheme="safariExtension://",this.listenPluginEvent=function(r,t){document.addEventListener?document.addEventListener(r,t,!1):document.documentElement.attachEvent("onpropertychange",function(e){e.propertyName===r&&t()})},a=S()?new function F(){var r=h,t=!1,e=!1;function C(u){if(u.source===r)try{var E=JSON.parse(u.data);E.type&&"FROM_IFC_EXT"===E.type?function i(u){if(u.intermediate)t(u);else if(t){var E=t;t=!1,E(u)}}(E.msg_data):E.type&&"IFC_EXT_DISCONNECT"===E.type&&function _(){if(t){var u=t;t=!1,u({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}e=!1}()}catch(d){}}this.send=function(u,E){if(t)E({error_code:IFCError.IFC_GENERAL_ERROR});else{var d=function c(){if(e)return IFCError.IFC_OK;try{r.addEventListener("message",C,!1)}catch(u){return IFCError.IFC_PLUGIN_UNDEFINED_ERROR}return e=!0,IFCError.IFC_OK}();d===IFCError.IFC_OK?function n(u,E){t=E;try{r.postMessage(JSON.stringify({type:"TO_IFC_EXT",msg_data:u}),"*")}catch(d){t=!1,E({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}}(u,E):E({error_code:d})}}}:new function D(t){this.send=function(e,n){try{t.post_message(JSON.stringify(e),function(i,_){n(JSON.parse(_))})}catch(i){n({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}}}(I),this.init=function(r){var t=this;this.status={isNativeMessaging:S(),isNewSafari:R(),extensionIsInstalled:null,pluginIsRunning:null},this.status.isNativeMessaging?setTimeout(function(){document.getElementById("ifcplugin-extension-is-installed")?(t.status.extensionIsInstalled=!0,t.status.pluginIsRunning=!!document.getElementById("ifc-plugin-is-installed")):t.status.extensionIsInstalled=!1,p("updatePluginStatus")},r?this.status.isNewSafari?5e3:500:4):(this.status.pluginIsRunning=!1,this.getPluginVersion(function(n){IFCError.IFC_OK===n.error_code&&(t.status.pluginIsRunning=!0)}),setTimeout(function(){p("updatePluginStatus")},1e3)),setTimeout(t.init.bind(t),5e3)},this.getLibVersion=function(r){return"2.2.1"},this.create=function(r,t,e){a.send({func_name:"create",params:{file_config:r,config_string:t,log_file_location:"",plugin_log_level:""}},e)},this.getPluginVersion=function(r){a.send({func_name:"version"},r)},this.getCryptoList=function(r){return l(r)},this.getPKCS11CryptoList=function(r){return P(IFCConst.IFC_CRYPTO_PKCS11,r)},this.getCAPICryptoList=function(r){return P(IFCConst.IFC_CRYPTO_CAPI,r)},this.getCAPILINUXCryptoList=function(r){return P(IFCConst.IFC_CRYPTO_CAPI_LINUX,r)},this.getCryptoById=function(r,t){return O(r,t)},this.getCertificateList=function(r){return U(r,0)},this.getCertificateListWithProgress=function(r){return U(r,1)},this.getCertificateListByCryptoId=function(r,t){return function W(r,t){O(r,function(e){if(IFCError.IFC_OK===e.error_code){var n=e.crypto;a.send({func_name:"get_list_certs",params:{cryptoID:n.getCryptoId()}},function(i){if(IFCError.IFC_OK===i.error_code){certsArray=[];for(var _=0;_<i.cert_list.length;_++)certsArray.push(new IFCCertificate(i.cert_list[_],n));t({error_code:IFCError.IFC_OK,certs_list:certsArray})}else t(i)})}else t(e)})}(r,t)},this.getKeyListByCryptoId=function(r,t,e){return function q(r,t,e){O(r,function(n){if(IFCError.IFC_OK===n.error_code){var i=n.crypto;!(t&&t.length>0)&&i.isPKCS11()&&e({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}),a.send({func_name:"get_list_keys",params:{cryptoID:i.getCryptoId(),userPin:t}},function(_){if(IFCError.IFC_OK===_.error_code){keysArray=[];for(var C=0;C<_.keys_list.length;C++)keysArray.push(new IFCCertificate(_.keys_list[C],i));e({error_code:IFCError.IFC_OK,keys_list:keysArray})}else e(_)})}else e(n)})}(r,t,e)},this.getCryptoIdByContainerId=function(r){return T(r)},this.signDataXml=function(r,t,e,n,i,_,C){return Y(r,t,e,n,IFCConst.IFC_DATATYPE_DATA,i,_,C)},o&&(this.verifyDataXml=function(r,t,e,n){return K(r,t,e,IFCConst.IFC_DATATYPE_DATA,n)}),this.signDataBase64Xml=function(r,t,e,n,i,_,C){return Y(r,t,e,n,IFCConst.IFC_DATATYPE_DATA_BASE64,i,_,C)},o&&(this.verifyDataBase64Xml=function(r,t,e,n){return K(r,t,e,IFCConst.IFC_DATATYPE_DATA_BASE64,n)}),this.signDataCmsAttached=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,n,i)},o&&(this.verifyDataCmsAttached=function(r,t,e){return N(r,t,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA,"",e)}),this.signDataCmsDetached=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,i)},o&&(this.verifyDataCmsDetached=function(r,t,e,n){return N(r,t,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,e,IFCConst.IFC_DATATYPE_DATA,"",n)}),this.signDataCadesBesAttached=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,n,i)},o&&(this.verifyDataCadesBesAttached=function(r,t,e){return N(r,t,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA,"",e)}),this.signDataCadesBesDetached=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,i)},o&&(this.verifyDataCadesBesDetached=function(r,t,e,n){return N(r,t,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,e,IFCConst.IFC_DATATYPE_DATA,"",n)}),this.signDataBase64CmsAttached=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,n,i)},o&&(this.verifyDataBase64CmsAttached=function(r,t,e){return N(r,t,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA_BASE64,"",e)}),this.signDataBase64CmsDetached=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,i)},o&&(this.verifyDataBase64CmsDetached=function(r,t,e,n){return N(r,t,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,e,IFCConst.IFC_DATATYPE_DATA_BASE64,"",n)}),this.signDataBase64CadesBesAttached=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,n,i)},o&&(this.verifyDataBase64CadesBesAttached=function(r,t,e){return N(r,t,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA_BASE64,"",e)}),this.signDataBase64CadesBesDetached=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,i)},o&&(this.verifyDataBase64CadesBesDetached=function(r,t,e,n){return N(r,t,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,e,IFCConst.IFC_DATATYPE_DATA_BASE64,"",n)}),this.signDataHash64CmsDetached=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,i)},o&&(this.verifyDataHash64CmsDetached=function(r,t,e,n){return N(r,t,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,e,IFCConst.IFC_DATATYPE_HASH_BASE64,"",n)}),this.signDataHash64CadesBesDetached=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,i)},o&&(this.verifyDataHash64CadesBesDetached=function(r,t,e,n){return N(r,t,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,e,IFCConst.IFC_DATATYPE_HASH_BASE64,"",n)}),this.signDataSimple=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_SIMPLE,n,i)},o&&(this.verifyDataSimple=function(r,t,e,n,i){return N(r,t,IFCConst.IFC_SIGNTYPE_SIMPLE,e,IFCConst.IFC_DATATYPE_DATA,n,i)}),this.signHashSimple=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_SIMPLE,n,i)},o&&(this.verifyHashSimple=function(r,t,e,n,i){return N(r,t,IFCConst.IFC_SIGNTYPE_SIMPLE,e,IFCConst.IFC_DATATYPE_HASH_BASE64,n,i)}),this.signDataSimpleReversed=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_SIMPLE_REVERSE,n,i)},o&&(this.verifyDataSimpleReversed=function(r,t,e,n,i){return N(r,t,IFCConst.IFC_SIGNTYPE_SIMPLE_REVERSE,e,IFCConst.IFC_DATATYPE_DATA,n,i)}),this.signDataBase64Simple=function(r,t,e,n,i){return g(r,t,e,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_SIMPLE,n,i)},o&&(this.verifyDataBase64Simple=function(r,t,e,n,i){return N(r,t,IFCConst.IFC_SIGNTYPE_SIMPLE,e,IFCConst.IFC_DATATYPE_DATA_BASE64,n,i)}),this.generateKeyPairAndCsrForContainerId=function(r,t,e,n){return function $(r,t,e,n){return M(r,t,e,"",n)}(r,t,e,n)},this.generateKeyPairAndCsrForContainerIdV2=function(r,t,e,n,i){return M(r,t,e,n,i)},this.generateKeyPairAndCsr=function(r,t,e,n){return function Z(r,t,e,n){return V(r,t,e,"",n)}(r,t,e,n)},this.generateKeyPairAndCsrV2=function(r,t,e,n,i){return V(r,t,e,n,i)},o&&(this.makeSelfSignedCert=function(r,t,e,n){return function J(r,t,e,n){O(T(r),function(_){IFCError.IFC_OK===_.error_code?t&&t.length>0||!_.crypto.isPKCS11()?a.send({func_name:"make_cert",params:{containerId:r,userPin:t,request:e}},function(C){n(C)}):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):n(_)})}(r,t,e,n)}),this.putCertificate=function(r,t,e,n){return function rt(r,t,e,n){O(T(r),function(_){IFCError.IFC_OK===_.error_code?t&&t.length>0||!_.crypto.isPKCS11()?v(e,function(C){if(IFCError.IFC_OK===C.error_code){var c=C.x509Handle;a.send({func_name:"set_x509",params:{containerId:r,userPin:t,x509Handle:c}},function(u){IFCError.IFC_OK===u.error_code?m(c,function(E){n(E)}):n(u)})}else n(C)}):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):n(_)})}(r,t,e,n)},this.deleteContainer=function(r,t,e){return X(r,t,e)},this.getGuid=function(r){return w(r)},this.setGuidPrefix=function(r){A=r},this.getGuidPrefix=function(){return A},this.getCertificate=function(r,t){return function tt(r,t){!function Q(r,t){a.send({func_name:"load_x509_from_container",params:{containerId:r}},t)}(r,function(e){if(IFCError.IFC_OK===e.error_code){var n=e.x509Handle;a.send({func_name:"get_x509_info",params:{x509Handle:n}},function(i){if(IFCError.IFC_OK===i.error_code){var _=new IFCCertificateInfo(i.cert_info);m(n,function(C){t({error_code:C.error_code,cert:_})})}else t(i)})}else t(e)})}(r,t)},this.getCertificateFromString=function(r,t){return function b(r,t){v(r,function(e){if(IFCError.IFC_OK===e.error_code){var n=e.x509Handle;!function k(r,t){a.send({func_name:"get_x509_info",params:{x509Handle:r}},function(e){if(IFCError.IFC_OK===e.error_code){var n=new IFCCertificateInfo(e.cert_info);t({error_code:e.error_code,cert:n})}else t(e)})}(n,function(i){if(IFCError.IFC_OK===i.error_code){var _=i.cert;m(n,function(C){t({error_code:C.error_code,cert:_})})}else t(i)})}else t(e)})}(r,t)},this.getHash=function(r,t,e){return H(r,IFCConst.IFC_DATATYPE_DATA,t,e)},this.getHashFromBase64=function(r,t,e){return H(r,IFCConst.IFC_DATATYPE_DATA_BASE64,t,e)},this.encrypt=function(r,t,e,n,i){return function et(r,t,e,n,i){t&&t.length>0?v(e,function(_){IFCError.IFC_OK===_.error_code?(peer_x509Handle=_.x509Handle,a.send({func_name:"encrypt",params:{containerId:r,userPin:t,peerX509Handle:peer_x509Handle,data:n}},function(C){var u,c=C.error_code;IFCError.IFC_OK===C.error_code&&(u=new IFCEncrypted(C.enc_data_base64,C.enc_key_base64,C.cert_base64)),m(peer_x509Handle,function(E){IFCError.IFC_OK===E.error_code?IFCError.IFC_OK===c?i({error_code:c,encrypted:u}):i({error_code:c}):i(E)})})):i(_)}):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(r,t,e,n,i)},this.decrypt=function(r,t,e,n,i,_){return function nt(r,t,e,n,i,_){t&&t.length>0?v(e,function(C){IFCError.IFC_OK===C.error_code?(peer_x509Handle=C.x509Handle,a.send({func_name:"decrypt",params:{containerId:r,userPin:t,peerX509Handle:peer_x509Handle,encryptedData:n,encryptedKey:i}},function(c){var E,u=c.error_code;IFCError.IFC_OK===c.error_code&&(E=c.decrypted),m(peer_x509Handle,function(d){IFCError.IFC_OK===d.error_code?IFCError.IFC_OK===u?_({error_code:u,decrypted:E}):_({error_code:u}):_(d)})})):_(C)}):_({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(r,t,e,n,i,_)},this.pkcs11Init=function(r,t,e,n,i){return function it(r,t,e,n,i){e&&e.length>0&&n&&n.length>0?a.send({func_name:"p11_init",params:{cryptoID:r,label:t,userPin:e,adminPin:n}},i):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(r,t,e,n,i)},this.pkcs11ChangeUserPin=function(r,t,e,n){return function _t(r,t,e,n){t&&t.length>0&&e&&e.length>0?a.send({func_name:"p11_pin_change",params:{cryptoID:r,pinType:IFCConst.P11_PIN_TYPE_USER,currentPin:t,newPin:e}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(r,t,e,n)},this.pkcs11UnlockUserPin=function(r,t,e){return function Ct(r,t,e){t&&t.length>0?a.send({func_name:"p11_pin_unlock",params:{cryptoID:r,adminPin:t}},e):e({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(r,t,e)},this.pkcs11ChangeAdminPin=function(r,t,e,n){return function ot(r,t,e,n){t&&t.length>0&&e&&e.length>0?a.send({func_name:"p11_pin_change",params:{cryptoID:r,pinType:IFCConst.P11_PIN_TYPE_ADMIN,currentPin:t,newPin:e}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(r,t,e,n)},this.pkcs11RenameContainer=function(r,t,e,n){return j(r,t,e,n)},this.pkcs11MoveContainer=function(r,t,e,n){return function It(r,t,e,n){e&&e.length>0?O(T(r),function(i){IFCError.IFC_OK===i.error_code?null!=i.crypto&&i.crypto.isPKCS11()?X(T(r)+"/"+t,e,function(C){(IFCError.IFC_OK===C.error_code||IFCError.IFC_CONTAINER_NOT_FOUND===C.error_code)&&j(r,t,e,n)}):n({error_code:IFCError.IFC_BAD_PARAMS}):n(i)}):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(r,t,e,n)},this.sendAPDU=function(r,t,e){return function st(r,t,e){a.send({func_name:"send_apdu",params:{readerName:r,apdu_string:t}},e)}(r,t,e)}}}(window);